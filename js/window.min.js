(function(){var m=false;var h=false;var d=false;var k=false;$(document).ready(function(){$(".window, .window *").on("click",function(p){if(b($(this).closest(".window"))){p.preventDefault();p.stopPropagation()}});$(".window, .window *").on("mousedown",function(p){if(b($(this).closest(".window"))){i($(".window[data-modal-parent="+$(this).closest(".window").attr("id")+"]"));p.preventDefault();p.stopPropagation()}});a();$(".window .btn-container.x-btn").on("click",function(p){if($(this).hasClass("disabled")){return}f($(this).closest(".window"))});$(".menu-item").on("mouseenter",function(p){$(this).addClass("selected")});$(".menu-item").on("mouseleave",function(p){$(this).removeClass("selected")});$(".menu, .menu *").on("mousedown",function(p){d=true});$(".menu-item:not(.disabled)").on("click",function(p){g()});$(".menu-btn").on("mousedown",function(r){var q=$(this);if(r.which==1){var p=true;if(h){if($(this).hasClass("active")){p=false}g()}if(p){l(q,r)}}});$(".menu-btn").on("mouseenter",function(q){if(h&&!$(this).hasClass("active")){var p=$(this);g();l(p,q)}});$(":not(.menu-btn, .menu-btn *, .menu, .menu *)").on("mousedown",function(p){if(h&&!d){g()}if($(this).is("html")){d=false}});$(".window").on("mousedown",function(p){k=true;o($(this))});$("body").on("mousedown",function(p){if(!k){$(".window").removeClass("focused")}k=false});$(".btns .btn-container").on("mousedown",function(p){if(!$(this).hasClass("active")){$(this).closest(".btns").find(".active").removeClass("active");$(this).closest(".btn-container").addClass("active")}})});function l(q){if(!h){q.addClass("active");h=true;d=true;var p=q.closest(".menu-bar").find(".menu#mnu_"+q.attr("id"));p.css("top",(q.height()+4)+"px");p.css("left",q.position().left+"px");p.css("display","inline-block")}}function g(){if(h){h=false;$(".menu-btn").removeClass("active");$(".menu").css("display","none")}d=false}function o(p){if(!p.hasClass("focused")){if(b(p)){return}$(".window").removeClass("focused");p.addClass("focused")}}function a(){var p=$(".title-bar *:not(.window-btns, .window-btns *, .icon)");p.on("mousedown",function(u){if(b($(this).closest(".window"))){return}if(u.which==1){m=true;var t=$(this).closest(".window");var s=t.offset();var r=u.pageX-s.left;var q=u.pageY-s.top;$("body").on("mousemove",function(v){t.css("top",(v.pageY-q)+"px");t.css("left",(v.pageX-r)+"px")})}});$("body").on("mouseup",function(q){if(m){if(q.which==1){$("body").off("mousemove");m=false}}})}function j(q,s,r,p){if(q.hasClass("window")&&!q.hasClass("open")){if(typeof s!=="undefined"&&typeof r!=="undefined"){q.css("left",s+"px")}if(typeof r!=="undefined"){q.css("top",r+"px")}if(p&&p.length&&p.hasClass("window")){p.addClass("modal-frozen");q.addClass("modal");q.attr("data-modal-parent",p.attr("id"))}o(q);q.addClass("open")}}function f(q){if(q.hasClass("window")&&q.hasClass("open")&&!b(q)){q.removeClass("open active focused");q.find(".btn-container.active").removeClass("active");q.find(".btn-container.default").addClass("active");if(q.hasClass("modal")){var p=q.data("modal-parent")||false;if(p!==false){$("#"+p).removeClass("modal-frozen");o($("#"+p));q.attr("data-modal-parent","")}q.removeClass("modal")}else{}}}function b(q){var p=false;$(".window.modal.open").each(function(){if($(this).data("modal-parent")==q.attr("id")){p=true;return}});return p}function i(p){if(p.hasClass("focused")){c(p,70,3)}else{o(p)}}function n(p){c(p,500,0)}function c(r,p,q){if(!r.hasClass("window")||!r.hasClass("open")){return}if(r.data("is-blinking")){e(r)}r.data("blinks-completed",0);r.data("is-blinking",true);r.data("blink-timer",window.setInterval(function(v,u){if(!v.length){e(v);return}var s=v.data("blinks-completed")+1;v.data("blinks-completed",s);var t=v.find(".title-bar").first();if(s%2!=0){t.addClass("blinking")}else{t.removeClass("blinking")}if(u!=0&&v.data("blinks-completed")==u*2){e(v)}},p,r,q||0))}function e(p){if(!p.length||typeof p.data("blink-timer")=="undefined"){return}window.clearInterval(p.data("blink-timer"));p.data("is-blinking",false);p.removeClass("blinking")}window.SweeperOSEnvironment={showWindow:j,closeWindow:f,blinkWindow:n}})();